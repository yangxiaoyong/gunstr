<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>MBR和grub工作原理(zz)_lead my new life_百度空间</title><link rel="alternate" type="application/rss+xml" title="订阅该空间的博客文章" href="http://hi.baidu.com/leembong/rss">
<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head>
<body><iframe src="index_1.html" name="_BdPopupLayer_a49s0i-hxfajgg8pic0-flqv2w" style="position: absolute; z-index: 65001; display: none;" id="_BdPopupLayer_a49s0i-hxfajgg8pic0-flqv2w" frameborder="0" scrolling="no"></iframe><iframe src="index_2.html" name="_BdPopupLayer_3uyhe8-vczmlh9vaj4s-h2wa1n" style="position: absolute; z-index: 65001; display: none;" id="_BdPopupLayer_3uyhe8-vczmlh9vaj4s-h2wa1n" frameborder="0" scrolling="no"></iframe> <!--[if (lt IE 8.0)]><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/cblog/css/ui/mods.css?v=774e31a7.css"><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><!--<![endif]--><!--[if (lt IE 8.0)]><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/cblog/css/space.css?v=85fd7152.css"><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><!--<![endif]--><div class="userbar"><center> <div id="nav"><a class="logo" href="http://hi.baidu.com/index.htm"><img src="logo_93_30.gif" alt="百度空间" border="0"></a><div class="manage no-login"><form action="https://passport.baidu.com/?login" method="post">用户名:<input value="" name="username">&nbsp;&nbsp; 密码:<input name="password" type="password"> <input name="mem_pass" value="on" type="hidden"><input value="" style="width: 0pt; height: 0pt;" type="submit"><a href="#" class="loginlink" onclick="this.parentNode.submit(); return false;">登录</a> </form> <a href="http://hi.baidu.com/reg/new" class="reglink">注册</a></div> </div></center></div><center><div id="main" align="left"><!--[if IE]><script>
var objmain = document.getElementById("main");
function updatesize(){ var bodyw = window.document.body.offsetWidth; if(bodyw <= 790) objmain.style.width="772px"; else if(bodyw >= 1016) objmain.style.width="996px"; else objmain.style.width="100%"; }
updatesize(); window.onresize = updatesize;
</script><![endif]--><div id="header"><div class="lc"><div class="rc"></div></div><div class="tit"><a href="http://hi.baidu.com/leembong" class="titlink" title="rimbong的空间 http://hi.baidu.com/leembong">lead my new life</a></div><div class="desc">joke,life,computer,myself</div><div id="tabline">&nbsp;</div><div id="tab"><a href="http://hi.baidu.com/leembong/home">主页</a><a href="http://hi.baidu.com/leembong/blog" class="on">博客</a><a href="http://hi.baidu.com/leembong/album">相册</a><span>|</span><a href="http://hi.baidu.com/leembong/profile">个人档案</a><span>|</span><a href="http://hi.baidu.com/leembong/friends">好友</a><span>|</span><a href="http://tieba.baidu.com/i/sys/jump?un=rimbong&amp;fr=spacebar" onclick="BdUtil.ns_trackerLink('m_20110330_spacebar','')" target="_top">i贴吧</a></div></div><div class="stage"><div class="stagepad"><div style="width: 100%;"><table class="modth" border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="modtl" width="7">&nbsp;</td><td class="modtc" nowrap="nowrap"><div class="modhead"><span class="modtit">查看文章</span></div></td><td class="modtc" align="right" nowrap="nowrap"></td><td class="modtr" width="7">&nbsp;</td></tr></tbody></table><div id="m_blog" class="modbox" style="overflow-x: hidden;"><div class="tit">MBR和grub工作原理(zz)</div><div class="date">2010-01-19 18:52</div><table style="table-layout: fixed; width: 100%;"><tbody><tr><td><div id="blog_text" class="cnt">在坛子里找到一篇关于grub和mbr工作原理的文章，以前一直都是一头雾水，今天转这文章学习下。。哈。。<br>
<br>
能正常工作的grub应该包括一下文件：stage1、stage2、*stage1_5、menu.lst。 <br>
<br>
其中stage1要被安装（也就是写入）某个硬盘的主引导记录，或者某个活动分区（这个分区要用fdisk标记成可启动的）的启动扇区。stage1的主要的也是唯一的作用就是找到你存放在硬盘上某个地方的stage2文件，来完成后续的工作。 <br>
<br>
stage2文件可以存在某个特定的文件系统中，比如你分了一个linux分区，在上面创建一个ext2文件系统，然后把这个文件拷贝到这个分区的某个目录下。也可以把stage2直接存放在硬盘的某个位置，也就是未分区的某个地方。不过，好像没有多少人会这么做吧。 <br>
<br>
因为stage1的容量有限（主引导记录MBR和启动扇区的大小只能够是512字节），所以它对文件系统是无法识别的，那如果你把 stage2存放在ext2或者fat格式的文件系统上，它如何来找到这个文件呢？这就要用到上面提到的那些stage1_5的文件了，它们负责解释文件 系统。你的stage2放在什么格式的文件系统上，就要调用对应的那个stage1_5文件。比如，你把stage2存放在ext2格式的文件系统上，就 需要e2fs_stage1_5；stage2存放在fat格式的文件系统上，就需要fat_stage1_5了,stage1.5可以安装在 mbr 之后的位置。 <br>
<br>
<br>
接下来是简单开机过程 <br>
<br>
①按下电源后，计算机自检（POST），如果硬件设备（CPU、内存、硬盘、光驱、各种卡）都没有问题，BIOS会检查各个硬盘的MBR，看有没 有可以执行的代码，如果你把grub安装到第一个硬盘的MBR上，那BIOS就会找到它，然后把控制权交个这段代码（其实就是512字节大小的 stage1）。 <br>
<br>
②stage1根据安装时提供的信息，如stage2在什么地方，需不需要加载文件系统的对应的stage1_5文件等，找 <br>
<br>
到stage2文件，并把控制权交给stage2。 <br>
<br>
③stage2会需要特定位置的grub配置文件menu.lst文件(此文件是/boot/gurb/gurb.conf的链接文件)，如 果找到，就分析其中的内容，形成操作系统选择菜单（Grub管它叫Menu Interface），如果没有找到menu.lst或者这个文件的格式、内容有错误，那就显示grub的命令行提示符。 <br>
<br>
④当你选择了菜单中相应的条目，或者输入了相关的命令，就可以看是引导系统了。比如引导linux的话，stage2会负责将vmlinuz和initrd（如果有的话）装载到内存，并把控制权交给vmlinuz。 <br>
<br>
⑤linux的内容完成对硬件的初始化，并把控制权交给init程序，完成后续的工作了。 <br>
<br>
详细的grub信息请参考：http://q.yesky.com/frame.jsp?referer=http%3A%2F%2Fq.yesky.com%2Fgroup%2Freview-17848168.html<br>
<h1 style="font-weight: normal;"><font size="3">Linux 引导过程内幕:http://www.ibm.com/developerworks/cn/linux/l-linuxboot/index.html</font></h1></div></td></tr></tbody></table><br><div class="opt" id="blogOpt"><a href="http://hi.baidu.com/leembong/blog/category/linux%26%2338%3Bcomputer" title="查看该分类中所有文章">类别：linux&amp;computer</a><span class="x-blog-opt-sp">|</span><a href="#" onclick="addToShare(); return false;" target="_top"><img src="share_btn.gif" align="absbottom" border="0"></a><span class="x-blog-opt-sp">|</span><a title="将此文章添加到百度搜藏" href="http://cang.baidu.com/do/add" onclick="return addToFavor();" target="_top">添加到搜藏</a> <span class="x-blog-opt-sp">|</span><a title="将此文章分享到i贴吧" href="#" onclick="addToiTieba(); return false;" target="_top">分享到i贴吧</a><span class="x-blog-opt-sp">|</span>浏览(<span id="result">768</span>)<span class="x-blog-opt-sp">|</span><a href="#send">评论</a>&nbsp;(<span id="blogCmtCount">0</span>)<div style="height: 5px; line-height: 5px;">&nbsp;</div><div id="in_nav">上一篇：<a href="http://hi.baidu.com/leembong/blog/item/fc20083554e7dbbcd0a2d3b2.html" title="awk 中文手册">awk 中文手册</a>&nbsp;&nbsp;&nbsp;&nbsp;下一篇：<a href="http://hi.baidu.com/leembong/blog/item/fcef22d7bf11182407088b84.html" title="泡椒田鸡，挺不错的">泡椒田鸡，挺不错的</a></div></div><div class="line">&nbsp;</div><div id="in_related_tmp"></div><div id="in_reader"> <div class="tit">最近读者：</div><table width="100%"><tbody><tr><td align="center" width="10%"><img src="portraitn.jpg" height="55" border="0" width="55"></td><td align="left" width="12%"><a href="http://tx.bdimg.com/?login&amp;tpl=sp&amp;tpl_reg=sp&amp;u=http%3A%2F%2Fhi.baidu.com%2Fleembong%2Fblog%2Fitem%2Fca6e954f7179fec1d1c86ab3.html" target="_self" onclick="BdUtil.relogin(); return false;">登录</a>后，您就出现在这里。</td><td class="user" align="center" valign="bottom" width="10%"><a href="http://hi.baidu.com/jackstrawkevin" target="_top" class="ucard" pid="6d1d4a61636b73747261774b6576696ea01e"><img src="6d1d4a61636b73747261774b6576696ea01e.jpg" border="0"></a></td><td class="user" align="center" valign="bottom" width="10%"><a href="http://hi.baidu.com/bbnnmmvvd" target="_top" class="ucard" pid="103762626e6e6d6d767664441f"><img src="103762626e6e6d6d767664441f.jpg" border="0"></a></td><td class="user" align="center" valign="bottom" width="10%"><a href="http://hi.baidu.com/mutouyihao" target="_top" class="ucard" pid="6b7f6d75746f75796968616fd505"><img src="6b7f6d75746f75796968616fd505.jpg" border="0"></a></td><td class="user" align="center" valign="bottom" width="10%"><a href="http://hi.baidu.com/c211989" target="_top" class="ucard" pid="8d3b633231313938398b1d"><img src="8d3b633231313938398b1d.jpg" border="0"></a></td><td class="user" align="center" valign="bottom" width="10%"><a href="http://hi.baidu.com/yovin" target="_top" class="ucard" pid="7133796f76696e5c02"><img src="7133796f76696e5c02.jpg" border="0"></a></td><td class="user" align="center" valign="bottom" width="10%"><a href="http://hi.baidu.com/rorokiki" target="_top" class="ucard" pid="1cf1726f726f6b696b695801"><img src="1cf1726f726f6b696b695801.jpg" border="0"></a></td><td class="user" align="center" valign="bottom" width="10%"><a href="http://hi.baidu.com/troyme" target="_top" class="ucard" pid="300374726f796d653301"><img src="300374726f796d653301.jpg" border="0"></a></td><td class="user" align="center" valign="bottom" width="10%"><a href="http://hi.baidu.com/kof%E5%B0%8F%E6%B8%94" target="_top" class="ucard" pid="a17b4b4f46d0a1d3e63409"><img src="a17b4b4f46d0a1d3e63409.jpg" border="0"></a></td><td width="100%"></td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td class="user" align="center" valign="top"><a href="http://hi.baidu.com/jackstrawkevin" target="_top" class="ucard" pid="6d1d4a61636b73747261774b6576696ea01e">JackstrawKevin</a></td><td class="user" align="center" valign="top"><a href="http://hi.baidu.com/bbnnmmvvd" target="_top" class="ucard" pid="103762626e6e6d6d767664441f">bbnnmmvvd</a></td><td class="user" align="center" valign="top"><a href="http://hi.baidu.com/mutouyihao" target="_top" class="ucard" pid="6b7f6d75746f75796968616fd505">mutouyihao</a></td><td class="user" align="center" valign="top"><a href="http://hi.baidu.com/c211989" target="_top" class="ucard" pid="8d3b633231313938398b1d">c211989</a></td><td class="user" align="center" valign="top"><a href="http://hi.baidu.com/yovin" target="_top" class="ucard" pid="7133796f76696e5c02">yovin</a></td><td class="user" align="center" valign="top"><a href="http://hi.baidu.com/rorokiki" target="_top" class="ucard" pid="1cf1726f726f6b696b695801">rorokiki</a></td><td class="user" align="center" valign="top"><a href="http://hi.baidu.com/troyme" target="_top" class="ucard" pid="300374726f796d653301">troyme</a></td><td class="user" align="center" valign="top"><a href="http://hi.baidu.com/kof%E5%B0%8F%E6%B8%94" target="_top" class="ucard" pid="a17b4b4f46d0a1d3e63409">KOF小渔</a></td><td></td></tr></tbody></table></div><div class="line">&nbsp;</div><div id="in_comment"> <a name="comment"></a> <div class="tit">网友评论：</div> <span id="userCommentList"></span> <div id="page"></div></div><form action="http://hi.baidu.com/leembong/commit" id="blogCmtSubmitForm" name="blogCmtSubmitForm" method="post"> <input name="bdstoken" value="the fisrt two args should be string type:0,1!" type="hidden"> <input name="ct" value="8" type="hidden"> <input name="cm" value="2" type="hidden"> <input name="spBlogID" value="ca6e954f7179fec1d1c86ab3" type="hidden"> <input name="spBlogCmtID" value="" type="hidden"> <input name="spRefURL" value="" type="hidden"></form><div id="in_send"><a name="send"></a><form name="form1" id="popFormSubmit" action="http://hi.baidu.com/leembong/commit" method="post" onsubmit="return checkcmtform()"><input name="bdstoken" value="the fisrt two args should be string type:0,1!" type="hidden"><input name="ct" value="8" type="hidden"><input name="cm" value="1" type="hidden"><input name="spBlogID" value="ca6e954f7179fec1d1c86ab3" type="hidden"><input value="http://hi.baidu.com/leembong/blog/item/ca6e954f7179fec1d1c86ab3.html" name="spRefURL" id="spRefURL" type="hidden"><div class="tit">发表评论：</div><table border="0" cellpadding="0" cellspacing="5" width="620"><tbody><tr><td class="f14">姓　名：</td><td><input value="" name="spBlogCmtor" id="spBlogCmtor" style="width: 220px;" tabindex="1" onchange="checkname('spBlogCmtor')" maxlength="49" onfocus="hidErr(1);"> &nbsp;&nbsp; <a href="http://hi.baidu.com/st/reg.html" target="_top">注册</a> | <a href="https://passport.baidu.com/?login&amp;tpl=sp&amp;tpl_reg=sp&amp;u=http%3A%2F%2Fhi.baidu.com%2Fleembong%2Fblog%2Fitem%2Fca6e954f7179fec1d1c86ab3.html" onclick="BdUtil.relogin(); return false;">登录</a><div style="display: none;" id="nmerror">*姓名最长为50字节</div></td></tr><tr id="1_err" style="display: none;"><td>&nbsp;</td><td><div class="error" id="1_err_con"></div></td></tr><tr><td class="f14">网址或邮箱：</td><td><input value="" name="spBlogCmtURL" id="spBlogCmtURL" style="width: 360px;" maxlength="128" tabindex="2" onchange="checkeandu('spBlogCmtURL')" onfocus="hidErr(2);"> (选填)</td></tr><tr id="2_err" style="display: none;"><td>&nbsp;</td><td><div class="error" id="2_err_con"></div></td></tr><tr><td class="f14" id="reTitle" valign="top">内　容：</td><td>        <div id="bdeditor_container_4gqepb-g7fs1abg2stf-dklbl9">            <table height="155px" border="0" cellpadding="0" cellspacing="0" width="100%">                <tbody><tr>                    <td style="display: none;" id="editor_toolbar_4gqepb-g7fs1abg2stf-dklbl9" class="ToolbarContainer"><div class="ToolbarStrip"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td nowrap="nowrap"><div class="ToolbarItem" title="插入表情" id="ToolbarItem_wy9n9s-1qnwg4ezi6zq-93oy00" onclick="_Instance['wy9n9s-1qnwg4ezi6zq-93oy00'].clickHandler(this)" onmouseup="_Instance['wy9n9s-1qnwg4ezi6zq-93oy00'].mouseUpHandler(this)" onmousedown="_Instance['wy9n9s-1qnwg4ezi6zq-93oy00'].mouseDownHandler(this)"><div class="img Smiley" alt="插入表情"><font style="font-size: 12px;">插入表情</font></div></div></td></tr></tbody></table></div></td>                </tr>                <tr>                    <td id="editor_area_4gqepb-g7fs1abg2stf-dklbl9" class="EditorContainer"><iframe src="index_3.html" frameborder="0" height="155px" width="100%"></iframe></td>                </tr>            </tbody></table>        </div>    <textarea name="spBlogCmtText" id="spBlogCmtText" style="width: 520px; height: 155px; display: none;" tabindex="3" onfocus="hidErr(3);" onclick="BdUtil.relogin(); return false;"></textarea><img style="cursor: pointer ! important; display: none ! important; position: absolute ! important; padding: 0pt ! important; margin: 0pt ! important; border: medium none ! important; width: 28px ! important; height: 14px ! important; opacity: 0.0152174 ! important;" title="It's All Text!" src="chrome://itsalltext/locale/gumdrop.png"></td></tr><tr id="3_err" style="display: none;"><td>&nbsp;</td><td><div class="error" id="3_err_con"></div></td></tr><tr><td class="f14" valign="top">&nbsp;</td><td class="f14" valign="top"><input id="btn_ok" name="btn_ok" autocomplete="off" onclick="BdUtil.relogin(); return false;" value="发表评论" tabindex="5" type="submit">&nbsp;&nbsp;&nbsp;&nbsp;<a href="#" id="cancleReLink" onclick="canclereply(); return false;" style="display: none; font-size: 12px; color: rgb(102, 102, 102);">取消回复</a></td></tr></tbody></table></form></div><br></div><table height="8" border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="modbl" width="7">&nbsp;</td><td class="modbc">&nbsp;</td><td class="modbr" width="7">&nbsp;</td></tr></tbody></table></div></div></div></div><div class="clearfix"></div><div style="text-align: center; margin: 30px auto 15px; font-family: Arial,simsun; font-size: 12px;"><div style="margin: 0pt auto 6px;"><a href="http://help.baidu.com/question?prod_en=space" target="_top" style="color: rgb(0, 0, 204);">帮助中心</a><span>&nbsp;|&nbsp;</span><a href="http://tieba.baidu.com/f?kw=%B0%D9%B6%C8%BF%D5%BC%E4&amp;fr=wwwt" target="_top" style="color: rgb(0, 0, 204);">空间客服</a><span>&nbsp;|&nbsp;</span><a href="http://tousu.baidu.com/hi/" target="_top" style="color: rgb(0, 0, 204);">投诉中心</a><span>&nbsp;|&nbsp;</span><a href="http://www.baidu.com/search/hi_contract.html" target="_top" style="color: rgb(0, 0, 204);">空间协议</a></div><div style="color: rgb(122, 119, 200);">©2012&nbsp;Baidu</div></div></center><ul id="blogCmtContentList" style="display: none;"></ul><iframe id="submitiframe" name="submitiframe" src="index_4.html" style="display: none;"></iframe></body>
</html>
